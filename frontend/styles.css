:root{
  --bg:#0a0b10;
  --ink:#e7decf;
  --ink-dim:#c6bba8;
  --gold:#f5d07f;
  --aqua:#7bd4cf;
  --violet:#b296ff;
  --paper:#15141a;
  --paper-2:#1b1a22;
  --ring: 0 0 50px 8px rgba(229,204,120,.10), 0 0 120px 24px rgba(123,212,207,.05);
}

*{ box-sizing:border-box }

html,body{
  height:100%;
  background: radial-gradient(1200px 900px at 70% -10%, #1a1630 0%, #0e0f19 45%, var(--bg) 100%) fixed;
  color:var(--ink);
  margin:0;
  font-family:"Crimson Pro", serif;
  letter-spacing:.2px;
}

.page-title{
  text-align:center;
  padding:32px 16px 8px;
  position:relative;
  z-index:2;
}

.page-title h1{
  margin:0;
  font-family:"Cinzel", serif;
  font-weight:700;
  font-size: clamp(28px, 3.8vw, 56px);
  letter-spacing:.06em;
  background: linear-gradient(90deg, var(--gold), #fff, var(--aqua), var(--violet));
  -webkit-background-clip:text;
  background-clip:text;
  color:transparent;
  text-shadow: 0 0 12px rgba(245,208,127,.25);
}

.stage{
  display:grid;
  place-items:center;
  padding: min(4vw, 40px);
  min-height: calc(100dvh - 140px);
  position:relative;
  z-index:2;
}

.grimoire{
  width: min(100%, 980px);
  backdrop-filter: blur(6px) saturate(110%);
  position:relative;
}

.glow-ring{
  position:absolute;
  inset:-18px;
  border-radius:28px;
  pointer-events:none;
  box-shadow: var(--ring);
  animation: slowPulse 8s ease-in-out infinite;
}

@keyframes slowPulse{
  0%,100%{ box-shadow: 0 0 60px 10px rgba(229,204,120,.10), 0 0 160px 28px rgba(178,150,255,.05) }
  50%{     box-shadow: 0 0 90px 15px rgba(123,212,207,.12), 0 0 180px 36px rgba(245,208,127,.07) }
}

.chat-window{
  background:
    radial-gradient(800px 400px at 10% -20%, rgba(245,208,127,.08) 0%, transparent 50%),
    radial-gradient(600px 300px at 90% 120%, rgba(123,212,207,.08) 0%, transparent 55%),
    linear-gradient(180deg, var(--paper), var(--paper-2));
  border:1px solid rgba(255,255,255,.06);
  border-radius:22px;
  padding:18px 18px 0;
  height: min(62vh, 520px);
  overflow: auto;
  box-shadow:
    inset 0 1px 0 rgba(255,255,255,.04),
    0 20px 60px rgba(0,0,0,.45);
  scroll-behavior: smooth;
}

/* zprávy */
.bubble{
  max-width: 78%;
  padding: 12px 14px;
  border-radius: 14px;
  margin: 10px 0;
  line-height: 1.5;
  font-size: 16px;
  white-space: pre-wrap;
  word-wrap: break-word;
  background: rgba(255,255,255,.04);
  border: 1px solid rgba(255,255,255,.06);
  box-shadow: 0 4px 18px rgba(0,0,0,.25);
  overflow-wrap:anywhere;
  word-break: break-word;
}
.bubble.user{
  margin-left:auto;
  background: linear-gradient(180deg, rgba(245,208,127,.12), rgba(245,208,127,.06));
  border-color: rgba(245,208,127,.22);
}
.bubble.bot{
  margin-right:auto;
  background: linear-gradient(180deg, rgba(178,150,255,.10), rgba(178,150,255,.05));
  border-color: rgba(178,150,255,.22);
}

.chat-input{
  display:flex;
  gap:10px;
  margin-top:14px;
  background: rgba(255,255,255,.03);
  border:1px solid rgba(255,255,255,.08);
  border-radius:16px;
  padding:10px;
  align-items:center;
}

.chat-input input{
  flex:1;
  background: transparent;
  border:none;
  color: var(--ink);
  font-size:16px;
  padding:10px 12px;
  outline:none;
}

.chat-input button{
  appearance:none;
  border:none;
  border-radius:12px;
  padding:10px 14px;
  font-family:"Cinzel", serif;
  font-weight:600;
  letter-spacing:.04em;
  color:#0a0b10;
  background: linear-gradient(180deg, var(--gold), #e9c66a);
  box-shadow: 0 8px 20px rgba(245,208,127,.25);
  cursor:pointer;
  transition: transform .06s ease, box-shadow .2s ease;
}
.chat-input button:active{ transform: translateY(1px) }
.chat-input button:hover{ box-shadow: 0 12px 28px rgba(245,208,127,.35) }
.chat-input button[disabled]{ opacity:.65; cursor:not-allowed; box-shadow:none }

.tiny-hint{
  opacity:.65;
  font-size:12px;
  margin:8px 2px 0;
}

.footnote{
  text-align:center;
  padding: 14px 10px 22px;
  opacity:.6;
  font-size: 13px;
}

/* hvězdná obloha */
#starfield{
  position:fixed;
  inset:0;
  z-index:0;
  display:block;
}

/* mlha */
.mist{
  position:fixed;
  inset:0;
  background:
    radial-gradient(1200px 600px at 20% 10%, rgba(255,255,255,.06), transparent 60%),
    radial-gradient(900px 450px at 80% 90%, rgba(255,255,255,.05), transparent 60%);
  mix-blend-mode: screen;
  opacity:.45;
  animation: drift 60s linear infinite;
  z-index:1;
}
@keyframes drift{
  0%{ transform: translate3d(0,0,0) }
  50%{ transform: translate3d(-2%, -1%, 0) }
  100%{ transform: translate3d(0,0,0) }
}

/* runy */
.runes{
  position:fixed; inset:0;
  pointer-events:none;
  z-index:1;
}
.runes span{
  position:absolute;
  font-family: "Cinzel", serif;
  color: rgba(255,255,255,.08);
  font-size: clamp(16px, 2.6vw, 30px);
  animation: float 18s ease-in-out infinite;
}
.runes span:nth-child(odd){ color: rgba(245,208,127,.09) }
@keyframes float{
  0%   { transform: translateY(0) rotate(0deg) }
  50%  { transform: translateY(-18px) rotate(6deg) }
  100% { transform: translateY(0) rotate(0deg) }
}

@media (prefers-reduced-motion: reduce){
  .glow-ring, .mist, .runes span{ animation: none !important }
}

/* malé obrazovky */
@media (max-width:700px){
  .bubble{ max-width: 88% }
  .chat-window{ height: 56vh }
}

/* === Rich content uvnitř bublin ======================================= */
.bubble .bubble-content p{ margin: 0 0 8px }
.bubble .bubble-content p:last-child{ margin-bottom: 0 }

/* Odkazy */
.bubble .bubble-content a{
  color: var(--aqua);
  text-decoration: underline;
  text-underline-offset: 2px;
  transition: opacity .15s ease;
  word-break: break-word;
}
.bubble .bubble-content a:hover{ opacity:.9 }
.bubble.user .bubble-content a{ color:#2b2b2b }
.bubble.user .bubble-content a:hover{ opacity:.85 }

/* Obrázkové náhledy */
.bubble .preview-img{
  display:block;
  max-width:100%;
  height:auto;
  border-radius:12px;
  margin-top:6px;
  box-shadow: 0 8px 24px rgba(0,0,0,.35);
  border:1px solid rgba(255,255,255,.08);
}

/* Seznamy */
.bubble .bubble-content ul,
.bubble .bubble-content ol{
  margin: 6px 0 6px 22px;
  padding: 0;
}
.bubble .bubble-content li{ margin: 4px 0 }

/* Kód */
.bubble .bubble-content code{
  background: rgba(255,255,255,.07);
  border:1px solid rgba(255,255,255,.1);
  border-radius:6px;
  padding: 2px 6px;
  font-family: ui-monospace, SFMono-Regular, Menlo, Consolas, monospace;
  font-size: 0.95em;
}
.bubble .bubble-content pre{
  background: rgba(0,0,0,.35);
  border:1px solid rgba(255,255,255,.08);
  border-radius:10px;
  padding: 10px 12px;
  overflow:auto;
}

/* Scrollbar */
.chat-window::-webkit-scrollbar{ width:10px }
.chat-window::-webkit-scrollbar-thumb{
  background: linear-gradient(180deg, rgba(255,255,255,.08), rgba(255,255,255,.03));
  border-radius:8px;
  border: 2px solid transparent;
  background-clip: padding-box;
}
.chat-window::-webkit-scrollbar-track{ background: transparent }

/* Loader shimmer (pokud použiješ .pending) */
.bubble.pending{ position:relative; overflow:hidden }
.bubble.pending::after{
  content:"";
  position:absolute; inset:0;
  background: linear-gradient(90deg,
    transparent 0%,
    rgba(255,255,255,.07) 45%,
    rgba(255,255,255,.12) 55%,
    transparent 100%);
  transform: translateX(-100%);
  animation: shimmer 1.2s ease-in-out infinite;
}
@keyframes shimmer{
  0%{ transform: translateX(-100%) }
  100%{ transform: translateX(100%) }
}

/* Typing (•••) animace */
.bubble.typing{
  display:inline-flex;
  align-items:center;
  gap:4px;
  padding:10px 14px;
  min-width:50px;
}
.typing-dot{
  width:6px;
  height:6px;
  border-radius:50%;
  background: rgba(255,255,255,.5);
  animation: typingPulse 1.2s infinite ease-in-out;
}
.typing-dot:nth-child(2){ animation-delay:.15s }
.typing-dot:nth-child(3){ animation-delay:.3s }
@keyframes typingPulse{
  0%,80%,100%{ transform: scale(0.6); opacity: .4 }
  40%{        transform: scale(1.0); opacity: 1 }
}
